<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GHS: src/demo/ghs-demo.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GHS
   </div>
   <div id="projectbrief">Leader Election Based on GHS Minimum Spanning Tree</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_ea2db1c5c9ef405bfa9ccf9d4f68ec9b.html">demo</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ghs-demo.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ghs-demo_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span> <span class="comment">//sleep</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span> <span class="comment">//better than iostream</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ghs-demo-config_8h.html">ghs-demo-config.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ghs-demo-msgutils_8h.html">ghs-demo-msgutils.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ghs-demo-comms_8h.html">ghs-demo-comms.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ghs_8h.html">ghs/ghs.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ghs__printer_8h.html">ghs/ghs_printer.h</a>&quot;</span> <span class="comment">//dump_edges</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="msg__printer_8h.html">ghs/msg_printer.h</a>&quot;</span> <span class="comment">//for printing GHS msgs.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="agent_8h.html">ghs/agent.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="edge_8h.html">ghs/edge.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="static__queue_8h.html">seque/static_queue.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">using</span> <a class="code" href="classle_1_1ghs_1_1GhsState.html">le::ghs::GhsState</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">using</span> <a class="code" href="namespacele_1_1ghs.html#a2fae5fec7662f91a571573e574b2f7c9">le::ghs::metric_t</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">using</span> <a class="code" href="namespacele_1_1ghs.html#a02e97afae479b0142591b5615f61d58e">le::ghs::agent_t</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">using</span> <a class="code" href="structle_1_1ghs_1_1Edge.html">le::ghs::Edge</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">using</span> <a class="code" href="structle_1_1ghs_1_1Msg.html">le::ghs::Msg</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacedemo.html">demo</a>{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classdemo_1_1GhsDemoExec.html">   70</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classdemo_1_1GhsDemoExec.html">GhsDemoExec</a>{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="classdemo_1_1GhsDemoExec.html#af699fd10cf0f833f88e4fdb32cbce039">do_main</a>(<span class="keywordtype">int</span> argc,<span class="keywordtype">char</span>**argv);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  };</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> AN, <span class="keywordtype">size_t</span> QN&gt;</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="namespacedemo.html#a2790b1b22d1cc8036c14a8d19e8c7aec">  100</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="namespacedemo.html#a2790b1b22d1cc8036c14a8d19e8c7aec">initialize_ghs</a>(<a class="code" href="classle_1_1ghs_1_1GhsState.html">GhsState&lt;AN,QN&gt;</a>&amp; ghs, <a class="code" href="structdemo_1_1Config.html">Config</a>&amp; cfg, <a class="code" href="classdemo_1_1Comms.html">Comms</a>&amp; c)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#a99d3eb11d5455ae117d917555a429842">reset</a>();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;cfg.<a class="code" href="structdemo_1_1Config.html#a5349577afa3f1ef846f84f9b7f36d684">n_agents</a>;i++){</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">if</span> (i!=cfg.<a class="code" href="structdemo_1_1Config.html#a14a344d67e7207aac087351cf2b0ae26">my_id</a>){</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;          <a class="code" href="namespacele_1_1ghs.html#a2fae5fec7662f91a571573e574b2f7c9">metric_t</a> link_wt = (<a class="code" href="namespacele_1_1ghs.html#a2fae5fec7662f91a571573e574b2f7c9">metric_t</a>) c.<a class="code" href="classdemo_1_1Comms.html#a1b2497ecccf0316c8e8c3a643037a8cc">unique_link_metric_to</a>(i);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#aea4d8fd7601b228107b8c91d087cca5c">set_edge</a>( { (<a class="code" href="namespacele_1_1ghs.html#a02e97afae479b0142591b5615f61d58e">agent_t</a>)i, (<a class="code" href="namespacele_1_1ghs.html#a02e97afae479b0142591b5615f61d58e">agent_t</a>)cfg.<a class="code" href="structdemo_1_1Config.html#a14a344d67e7207aac087351cf2b0ae26">my_id</a>, <a class="code" href="namespacele_1_1ghs.html#a84d3095aaf4e4704c377dd7fe2195632a84d0576afb701bea755a6cd2752555f2">UNKNOWN</a>, link_wt, } ); </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          printf(<span class="stringliteral">&quot;[info] Set edge: %d from %d (check=%d)\n&quot;</span>,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;              i,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;              cfg.<a class="code" href="structdemo_1_1Config.html#a14a344d67e7207aac087351cf2b0ae26">my_id</a>,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;              ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#a32752d80f78b09c368236e864de84e0d">has_edge</a>(i));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          <a class="code" href="structle_1_1ghs_1_1Edge.html">Edge</a> e;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#a491d9729e0a7ec8ec63e12c261c63af6">get_edge</a>(i,e);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          printf(<span class="stringliteral">&quot;[info] (%d&lt;--%d, %d %lu)\n&quot;</span>,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;              e.<a class="code" href="structle_1_1ghs_1_1Edge.html#ac5af30e895dd30418def560ffbcd83a9">peer</a>,e.<a class="code" href="structle_1_1ghs_1_1Edge.html#a2aadbbe58e3ae3143c7e228dc5aae2a8">root</a>,e.<a class="code" href="structle_1_1ghs_1_1Edge.html#aa097ecc6d3006a9442a61836b6a8b9c8">status</a>,e.<a class="code" href="structle_1_1ghs_1_1Edge.html#a8007d7f31ee60a36a944be01a4f6d60d">metric_val</a>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          printf(<span class="stringliteral">&quot;[info] Ignoring: %d (it&#39;s me)\n&quot;</span>, i);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> AN, <span class="keywordtype">size_t</span> QN&gt;</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="namespacedemo.html#a7d48c79c4beff0ef6734a1aeb0742093">  123</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="namespacedemo.html#a7d48c79c4beff0ef6734a1aeb0742093">kill_edge</a>(<a class="code" href="classle_1_1ghs_1_1GhsState.html">GhsState&lt;AN,QN&gt;</a>&amp; ghs, <a class="code" href="structdemo_1_1Config.html">Config</a> &amp; cfg, uint8_t agent_to)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordtype">bool</span> resp_req=<span class="keyword">false</span>, waiting_for=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#aea4d8fd7601b228107b8c91d087cca5c">set_edge</a>( {agent_to, (<a class="code" href="namespacele_1_1ghs.html#a02e97afae479b0142591b5615f61d58e">agent_t</a>) cfg.<a class="code" href="structdemo_1_1Config.html#a14a344d67e7207aac087351cf2b0ae26">my_id</a>, <a class="code" href="namespacele_1_1ghs.html#a84d3095aaf4e4704c377dd7fe2195632a4826c452cc9fd67119dc4d18c4bacb1b">DELETED</a>, 0} );</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#a7429a609856ffa154ad57e06fd9ac718">is_response_required</a>(agent_to, resp_req);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">if</span> (resp_req)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        printf(<span class="stringliteral">&quot;[info] response impossible: alerting GHS state machine to loss of agent\n&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#a25d346bd8cc18b48b7bc02396aba5387">set_response_required</a>(agent_to, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#a7d2dd6a4348cf7b0081bf349188f6abd">is_waiting_for</a>(agent_to, waiting_for);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">if</span> (waiting_for){</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        printf(<span class="stringliteral">&quot;[info] waiting illogical: alerting GHS state machine to loss of agent\n&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#acdffbfd844f9725278968aedef953c71">set_waiting_for</a>(agent_to, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="namespacedemo.html#ad8a09bcb86eeb80494bed646f3fa0fae">  144</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedemo.html#ad8a09bcb86eeb80494bed646f3fa0fae">do_test_and_die</a>(<a class="code" href="classdemo_1_1Comms.html">Comms</a>&amp; comms, <a class="code" href="structdemo_1_1Config.html">Config</a> &amp;config){</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    printf(<span class="stringliteral">&quot;[info] running connectivity test after %fs!\n&quot;</span>,config.<a class="code" href="structdemo_1_1Config.html#ae46a80fa61b7d31743cd11a8b78b5809">wait_s</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    sleep(config.<a class="code" href="structdemo_1_1Config.html#ae46a80fa61b7d31743cd11a8b78b5809">wait_s</a>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#a75296ec19c2098d8d9860baf311fc72e">start_receiver</a>();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    sleep(1);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#a3032da74e13c2e363da17acf1e4310fc">little_iperf</a>();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    sleep(1);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    printf(<span class="stringliteral">&quot;[info]================= measured\n&quot;</span>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#ae2a26114df1482d22c7f4a540d4cfea4">print_iperf</a>();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    sleep(1);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    printf(<span class="stringliteral">&quot;[info]================= exchanging \n&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#a2c1d0baea715a9b9f3e63022a5977b57">exchange_iperf</a>();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    sleep(1);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    printf(<span class="stringliteral">&quot;[info]================= post-exchange\n&quot;</span>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#ae2a26114df1482d22c7f4a540d4cfea4">print_iperf</a>();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    sleep(1);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    printf(<span class="stringliteral">&quot;[info]================= again\n&quot;</span>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#ae2a26114df1482d22c7f4a540d4cfea4">print_iperf</a>();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#a6ce39da083f7393eed3e23af716671c9">stop_receiver</a>();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="classdemo_1_1GhsDemoExec.html#af699fd10cf0f833f88e4fdb32cbce039">  166</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classdemo_1_1GhsDemoExec.html#af699fd10cf0f833f88e4fdb32cbce039">GhsDemoExec::do_main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="structdemo_1_1Config.html">demo::Config</a> config;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> COMMS_Q_SZ=256;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="namespacedemo.html#a058a0c6f9b6498fbf7108227b4ed2496">demo::read_cfg_stdin</a>(&amp;config);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="namespacedemo.html#a69165e1dd34db70c8f2dd6fc9457c3c5">demo::read_cfg_cli</a>(argc,argv,&amp;config);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    printf(<span class="stringliteral">&quot;[info] Done configuring for id=%d... \n&quot;</span>,config.<a class="code" href="structdemo_1_1Config.html#a14a344d67e7207aac087351cf2b0ae26">my_id</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacedemo.html#acdd343c748f1c00bfac0d5403b55ba65">demo::cfg_is_ok</a>(config)){</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">//initialize the buffer used for input &amp; output to get response messages from</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">//those state machines. </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">//Use your own here ... </span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="classseque_1_1StaticQueue.html">seque::StaticQueue&lt;Msg,COMMS_Q_SZ&gt;</a> buf;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">//initialize all the message-driven state machines that need msg callbacks.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">//In this case. Just GHS...</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="classle_1_1ghs_1_1GhsState.html">le::ghs::GhsState&lt;MAX_N,COMMS_Q_SZ&gt;</a> ghs(config.<a class="code" href="structdemo_1_1Config.html#a14a344d67e7207aac087351cf2b0ae26">my_id</a>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">//here&#39;s the queue to/from ghs TODO: unify message types.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classseque_1_1StaticQueue.html">seque::StaticQueue&lt;Msg,COMMS_Q_SZ&gt;</a> ghs_buf;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="classdemo_1_1Comms.html">demo::Comms</a> comms;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#a136a98dcdbe684313dbd6c141ffea02a">with_config</a>(config);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">if</span> (!comms.ok()){</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      printf(<span class="stringliteral">&quot;[error] Cannot create comms from config\n&quot;</span>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (config.<a class="code" href="structdemo_1_1Config.html#aaf5064e2ded3f48de39eab485a905eac">test</a>==1){</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacedemo.html#ad8a09bcb86eeb80494bed646f3fa0fae">demo::do_test_and_die</a>(comms,config);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> wegood=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">//stop loop on sigint</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    signal(SIGINT,[](<span class="keywordtype">int</span> s){</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        printf(<span class="stringliteral">&quot;...... Received shutdown, joining / killing all threads ..... \n&quot;</span>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        wegood=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        });</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (config.<a class="code" href="structdemo_1_1Config.html#ae46a80fa61b7d31743cd11a8b78b5809">wait_s</a>&gt;0){</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      printf(<span class="stringliteral">&quot;[info] sleeping for %f seconds\n&quot;</span>,config.<a class="code" href="structdemo_1_1Config.html#ae46a80fa61b7d31743cd11a8b78b5809">wait_s</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      sleep(config.<a class="code" href="structdemo_1_1Config.html#ae46a80fa61b7d31743cd11a8b78b5809">wait_s</a>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#a75296ec19c2098d8d9860baf311fc72e">start_receiver</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#a3032da74e13c2e363da17acf1e4310fc">little_iperf</a>();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#ae2a26114df1482d22c7f4a540d4cfea4">print_iperf</a>();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    sleep(1);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#a2c1d0baea715a9b9f3e63022a5977b57">exchange_iperf</a>();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#ae2a26114df1482d22c7f4a540d4cfea4">print_iperf</a>();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    sleep(1);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#ae2a26114df1482d22c7f4a540d4cfea4">print_iperf</a>();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (config.<a class="code" href="structdemo_1_1Config.html#a1f643d712a38616051730426e6ae32d7">command</a>==<a class="code" href="structdemo_1_1Config.html#a332f9a3722fd5ad86c8258eeca7f93f0a246ea6af03d2011fbf1fd4fff4e6be6d">demo::Config::START</a>){</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <a class="code" href="namespacedemo.html#a2790b1b22d1cc8036c14a8d19e8c7aec">demo::initialize_ghs</a>(ghs,config,comms);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordtype">size_t</span> sent;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keyword">auto</span> ret = ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#a817fb9ac310ad6d8cd51bb5094fa7f3d">start_round</a>(ghs_buf, sent);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">if</span> (ret != <a class="code" href="namespacele_1_1ghs.html#aac347dba4047a0b57893ee8895e66acba3e8f07e33611d026ddfea23364d4c437">le::ghs::OK</a>){</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        printf(<span class="stringliteral">&quot;[error] could not start ghs! (%d)\n&quot;</span>, ret);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    } </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">while</span> (wegood){</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="structdemo_1_1WireMessage.html">demo::WireMessage</a> in;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">//retrieve next message from background reader.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordtype">bool</span> ok = comms.<a class="code" href="classdemo_1_1Comms.html#a722a2024af447ac2ecefd15773c56fc2">get_next</a>(in);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">if</span> (ok){</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        printf(<span class="stringliteral">&quot;[info] recv&#39;d msg from %d to %d\n&quot;</span>,in.<a class="code" href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">header</a>.<a class="code" href="structdemo_1_1Header.html#a2f9c26f8fa4e85225de044b139df26d5">agent_from</a>, in.<a class="code" href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">header</a>.<a class="code" href="structdemo_1_1Header.html#aef68c9783cad9ea4952d7753fc03f517">agent_to</a>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">//no shenanegans plz</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        assert(in.<a class="code" href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">header</a>.<a class="code" href="structdemo_1_1Header.html#aef68c9783cad9ea4952d7753fc03f517">agent_to</a>==config.<a class="code" href="structdemo_1_1Config.html#a14a344d67e7207aac087351cf2b0ae26">my_id</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">//there might be other types, like link metrics, control messages, or</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment">//other subsystems to prod. etc</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">switch</span> (in.<a class="code" href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">header</a>.<a class="code" href="structdemo_1_1Header.html#abb8dcb07cdebd3d745df3aea8c3786bb">type</a>){</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="namespacedemo.html#a40728478aebe86a16a658e832186e97ca6ebaba8135dfea1dd78fdef26f257d0a">demo::PAYLOAD_TYPE_CONTROL</a>:</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            { </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="namespacedemo.html#a40728478aebe86a16a658e832186e97ca90d93bb46f68d3452708e7bf4a7eb1a4">demo::PAYLOAD_TYPE_GHS</a>:</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;              <span class="comment">//with static size checking:</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;              <span class="comment">//Msg payload_msg=from_bytes&lt;MAX_MSG_SZ&gt;(in.bytes); </span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;              <span class="comment">//or with compression / variable sizes</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;              <a class="code" href="structle_1_1ghs_1_1Msg.html">Msg</a> payload_msg = from_bytes(in.<a class="code" href="structdemo_1_1WireMessage.html#aaa2782b2201a65e477b0a54ae55509fc">bytes</a>, in.<a class="code" href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">header</a>.<a class="code" href="structdemo_1_1Header.html#add10fe1bdb49ba9d102eb84df7bb64d1">payload_size</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;              <span class="comment">//push msg to the subsystem</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;              std::stringstream ss;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;              ss&lt;&lt;payload_msg;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;              printf(<span class="stringliteral">&quot;[info] received GHS msg: %s\n&quot;</span>,ss.str().c_str());</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;              <span class="keywordtype">size_t</span> new_msg_ct=0;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;              <a class="code" href="namespacele_1_1ghs.html#aac347dba4047a0b57893ee8895e66acb">le::ghs::Retcode</a> retval = ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#a9389f079174e451d1e53b49ca87e33db">process</a>(payload_msg,ghs_buf, new_msg_ct);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;              <span class="keywordflow">if</span> (retval != <a class="code" href="namespacele_1_1ghs.html#aac347dba4047a0b57893ee8895e66acba3e8f07e33611d026ddfea23364d4c437">le::ghs::OK</a>){</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                printf(<span class="stringliteral">&quot;[error] could not call ghs.process():%s&quot;</span>,<a class="code" href="namespacele_1_1ghs.html#aae453b8c5ad07a483f01c531dbe3cd78">le::ghs::strerror</a>(retval));</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;              }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;              printf(<span class="stringliteral">&quot;[info] # response msgs: %zu\n&quot;</span>, new_msg_ct);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;              printf(<span class="stringliteral">&quot;[info] GHS waiting: %zu, delayed: %zu, leader: %d, parent: %d, level: %d\n&quot;</span>, </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                  ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#a30a22ed8e6d3e432da497631a99bd414">waiting_count</a>(),</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                  ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#aabb95007147563e87a19aaca69531ce2">delayed_count</a>(),</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                  ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#a6789e0899e91d62a6d2cc11a66833d89">get_leader_id</a>(), </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                  ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#abba914bec431efab91efc47c7f105057">get_parent_id</a>(),</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                  ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#ac34be79320fdff6ee68650d582fc7756">get_level</a>());</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;              printf(<span class="stringliteral">&quot;[info] Edges: %s\n&quot;</span>,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                  <a class="code" href="ghs__printer_8h.html#a33004d9801352831b8e199c7d17cbb3d">dump_edges</a>(ghs).c_str());</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          <span class="keywordflow">default</span>: { printf(<span class="stringliteral">&quot;[error] unknown payload type: %d\n&quot;</span>, in.<a class="code" href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">header</a>.<a class="code" href="structdemo_1_1Header.html#abb8dcb07cdebd3d745df3aea8c3786bb">type</a>); wegood=<span class="keyword">false</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="comment">//now process the outgoing msgs </span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="comment">//ghs example, others are similar:</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="comment">//You don&#39;t really *need* to wrap messages like this ... </span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keywordflow">while</span>(ghs_buf.<a class="code" href="classseque_1_1StaticQueue.html#a1411a295dffaaebd346dae90a15fca8d">size</a>()&gt;0){</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="structdemo_1_1WireMessage.html">demo::WireMessage</a> out;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="structle_1_1ghs_1_1Msg.html">le::ghs::Msg</a> out_pld;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        printf(<span class="stringliteral">&quot;[info] Have %zu msgs to send\n&quot;</span>, ghs_buf.<a class="code" href="classseque_1_1StaticQueue.html#a1411a295dffaaebd346dae90a15fca8d">size</a>());</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceseque.html#a83d9a4dc1b5b513df2fcf67dca9d440ca6db7d02c36017b6c1cea04b4d8d1354d">seque::OK</a>!=ghs_buf.<a class="code" href="classseque_1_1StaticQueue.html#ae1614af1da8a98ff8b0e8666de036a88">pop</a>(out_pld)){</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          wegood=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        out.<a class="code" href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">header</a>.<a class="code" href="structdemo_1_1Header.html#aef68c9783cad9ea4952d7753fc03f517">agent_to</a>=out_pld.<a class="code" href="structle_1_1ghs_1_1Msg.html#ab98db415023ed82008b48e8749b8a322">to</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        out.<a class="code" href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">header</a>.<a class="code" href="structdemo_1_1Header.html#a2f9c26f8fa4e85225de044b139df26d5">agent_from</a>=out_pld.<a class="code" href="structle_1_1ghs_1_1Msg.html#a67f976eac93bace02a9ef4ca6817a182">from</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        out.<a class="code" href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">header</a>.<a class="code" href="structdemo_1_1Header.html#abb8dcb07cdebd3d745df3aea8c3786bb">type</a>=<a class="code" href="namespacedemo.html#a40728478aebe86a16a658e832186e97ca90d93bb46f68d3452708e7bf4a7eb1a4">demo::PAYLOAD_TYPE_GHS</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        out.<a class="code" href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">header</a>.<a class="code" href="structdemo_1_1Header.html#add10fe1bdb49ba9d102eb84df7bb64d1">payload_size</a>=<span class="keyword">sizeof</span>(out_pld);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordtype">size_t</span> bsz = <span class="keyword">sizeof</span>(out_pld);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        to_bytes(out_pld,out.<a class="code" href="structdemo_1_1WireMessage.html#aaa2782b2201a65e477b0a54ae55509fc">bytes</a>,bsz);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        assert(bsz==<span class="keyword">sizeof</span>(out_pld));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <a class="code" href="namespacedemo.html#abf8c1fc7556d7ead827da53c62c160af">demo::Errno</a> retval=comms.<a class="code" href="classdemo_1_1Comms.html#aee289f13ddf0feed4d64a80ee40c140e">send</a>(out); </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">if</span> (retval==<a class="code" href="namespacedemo.html#abf8c1fc7556d7ead827da53c62c160afa58b77192fdebafe13fc97074d128e85b">demo::OK</a>){</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          std::stringstream ss;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          ss&lt;&lt;out_pld;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          printf(<span class="stringliteral">&quot;[info] Sent: %s\n&quot;</span>,ss.str().c_str());</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (retval == <a class="code" href="namespacedemo.html#abf8c1fc7556d7ead827da53c62c160afa7266344c8c38721c5322937df92267d6">demo::ERR_NNG</a> || retval == <a class="code" href="namespacedemo.html#abf8c1fc7556d7ead827da53c62c160afa650898b110370730426d95e0363f62ef">demo::ERR_HANGUP</a>){</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          <span class="keywordflow">if</span> (config.<a class="code" href="structdemo_1_1Config.html#ae26f1eefefaa9ab4a250ded8cd385e45">retry_connections</a>){</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            printf(<span class="stringliteral">&quot;[error] Could not send, will retry: %d\n&quot;</span>,retval);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            ghs_buf.<a class="code" href="classseque_1_1StaticQueue.html#ad527d3ce61dc2573e440e334df1d7050">push</a>(out_pld);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            printf(<span class="stringliteral">&quot;[error] Could not send, assuming gone: %d\n&quot;</span>,retval);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <a class="code" href="namespacedemo.html#a7d48c79c4beff0ef6734a1aeb0742093">kill_edge</a>(ghs, config, out.<a class="code" href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">header</a>.<a class="code" href="structdemo_1_1Header.html#aef68c9783cad9ea4952d7753fc03f517">agent_to</a>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          printf(<span class="stringliteral">&quot;[error] demo error. We may have populated a message incorreclty %d\n&quot;</span>,-retval);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordflow">if</span> (ghs.<a class="code" href="classle_1_1ghs_1_1GhsState.html#acf6f3f76c3e48e65e00e2887a9592d9f">is_converged</a>()){</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        printf(<span class="stringliteral">&quot;Converged!\n&quot;</span>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        wegood=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    printf(<span class="stringliteral">&quot;[info] waiting a bit for cleanup ... \n&quot;</span>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    sleep(3);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    comms.<a class="code" href="classdemo_1_1Comms.html#a6ce39da083f7393eed3e23af716671c9">stop_receiver</a>();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    printf(<span class="stringliteral">&quot;[info] Comms stopped ... Exiting\n&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_acdffbfd844f9725278968aedef953c71"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#acdffbfd844f9725278968aedef953c71">le::ghs::GhsState::set_waiting_for</a></div><div class="ttdeci">Retcode set_waiting_for(const agent_t &amp;who, const bool waiting_for)</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:750</div></div>
<div class="ttc" id="aghs-demo-msgutils_8h_html"><div class="ttname"><a href="ghs-demo-msgutils_8h.html">ghs-demo-msgutils.h</a></div><div class="ttdoc">Provides some convenience functions for dealing with demo::WireMessage buffers.</div></div>
<div class="ttc" id="anamespacele_1_1ghs_html_a02e97afae479b0142591b5615f61d58e"><div class="ttname"><a href="namespacele_1_1ghs.html#a02e97afae479b0142591b5615f61d58e">le::ghs::agent_t</a></div><div class="ttdeci">int agent_t</div><div class="ttdoc">problems for GhsState</div><div class="ttdef"><b>Definition:</b> agent.h:51</div></div>
<div class="ttc" id="aclassdemo_1_1Comms_html_a3032da74e13c2e363da17acf1e4310fc"><div class="ttname"><a href="classdemo_1_1Comms.html#a3032da74e13c2e363da17acf1e4310fc">demo::Comms::little_iperf</a></div><div class="ttdeci">void little_iperf()</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.cpp:381</div></div>
<div class="ttc" id="astructdemo_1_1WireMessage_html"><div class="ttname"><a href="structdemo_1_1WireMessage.html">demo::WireMessage</a></div><div class="ttdoc">A wire-ready message structure that can encapsulate a variety of payloads for sending across the wire...</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:168</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_aea4d8fd7601b228107b8c91d087cca5c"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#aea4d8fd7601b228107b8c91d087cca5c">le::ghs::GhsState::set_edge</a></div><div class="ttdeci">Retcode set_edge(const Edge &amp;e)</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:897</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_a30a22ed8e6d3e432da497631a99bd414"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#a30a22ed8e6d3e432da497631a99bd414">le::ghs::GhsState::waiting_count</a></div><div class="ttdeci">size_t waiting_count() const</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:934</div></div>
<div class="ttc" id="astructdemo_1_1Header_html_abb8dcb07cdebd3d745df3aea8c3786bb"><div class="ttname"><a href="structdemo_1_1Header.html#abb8dcb07cdebd3d745df3aea8c3786bb">demo::Header::type</a></div><div class="ttdeci">PayloadType type</div><div class="ttdoc">What payload type do we carry?</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:141</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_a817fb9ac310ad6d8cd51bb5094fa7f3d"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#a817fb9ac310ad6d8cd51bb5094fa7f3d">le::ghs::GhsState::start_round</a></div><div class="ttdeci">Retcode start_round(StaticQueue&lt; Msg, MSG_Q_SIZE &gt; &amp;outgoing_msgs, size_t &amp;)</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:91</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_a9389f079174e451d1e53b49ca87e33db"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#a9389f079174e451d1e53b49ca87e33db">le::ghs::GhsState::process</a></div><div class="ttdeci">Retcode process(const Msg &amp;msg, StaticQueue&lt; Msg, MSG_Q_SIZE &gt; &amp;outgoing_buffer, size_t &amp;sz)</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:107</div></div>
<div class="ttc" id="astructdemo_1_1Header_html_a2f9c26f8fa4e85225de044b139df26d5"><div class="ttname"><a href="structdemo_1_1Header.html#a2f9c26f8fa4e85225de044b139df26d5">demo::Header::agent_from</a></div><div class="ttdeci">uint16_t agent_from</div><div class="ttdoc">Which agent id is this from?</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:139</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_a7d2dd6a4348cf7b0081bf349188f6abd"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#a7d2dd6a4348cf7b0081bf349188f6abd">le::ghs::GhsState::is_waiting_for</a></div><div class="ttdeci">Retcode is_waiting_for(const agent_t &amp;who, bool &amp;out_waiting_for)</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:761</div></div>
<div class="ttc" id="aclassseque_1_1StaticQueue_html_a1411a295dffaaebd346dae90a15fca8d"><div class="ttname"><a href="classseque_1_1StaticQueue.html#a1411a295dffaaebd346dae90a15fca8d">seque::StaticQueue::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> static_queue_impl.hpp:63</div></div>
<div class="ttc" id="anamespacele_1_1ghs_html_aac347dba4047a0b57893ee8895e66acb"><div class="ttname"><a href="namespacele_1_1ghs.html#aac347dba4047a0b57893ee8895e66acb">le::ghs::Retcode</a></div><div class="ttdeci">Retcode</div><div class="ttdef"><b>Definition:</b> ghs.h:71</div></div>
<div class="ttc" id="aclassdemo_1_1Comms_html_a136a98dcdbe684313dbd6c141ffea02a"><div class="ttname"><a href="classdemo_1_1Comms.html#a136a98dcdbe684313dbd6c141ffea02a">demo::Comms::with_config</a></div><div class="ttdeci">Comms &amp; with_config(Config &amp;)</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.cpp:133</div></div>
<div class="ttc" id="anamespacele_1_1ghs_html_a2fae5fec7662f91a571573e574b2f7c9"><div class="ttname"><a href="namespacele_1_1ghs.html#a2fae5fec7662f91a571573e574b2f7c9">le::ghs::metric_t</a></div><div class="ttdeci">unsigned long metric_t</div><div class="ttdef"><b>Definition:</b> edge.h:63</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_a25d346bd8cc18b48b7bc02396aba5387"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#a25d346bd8cc18b48b7bc02396aba5387">le::ghs::GhsState::set_response_required</a></div><div class="ttdeci">Retcode set_response_required(const agent_t &amp;who, const bool response_required)</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:771</div></div>
<div class="ttc" id="aghs-demo-comms_8h_html"><div class="ttname"><a href="ghs-demo-comms_8h.html">ghs-demo-comms.h</a></div><div class="ttdoc">contains all the wire-level data structures and the Comms object to manage them.</div></div>
<div class="ttc" id="anamespacedemo_html_abf8c1fc7556d7ead827da53c62c160af"><div class="ttname"><a href="namespacedemo.html#abf8c1fc7556d7ead827da53c62c160af">demo::Errno</a></div><div class="ttdeci">Errno</div><div class="ttdoc">return codes for the Comms object</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:72</div></div>
<div class="ttc" id="aclassseque_1_1StaticQueue_html_ad527d3ce61dc2573e440e334df1d7050"><div class="ttname"><a href="classseque_1_1StaticQueue.html#ad527d3ce61dc2573e440e334df1d7050">seque::StaticQueue::push</a></div><div class="ttdeci">Retcode push(const T item)</div><div class="ttdef"><b>Definition:</b> static_queue_impl.hpp:68</div></div>
<div class="ttc" id="anamespacedemo_html_a2790b1b22d1cc8036c14a8d19e8c7aec"><div class="ttname"><a href="namespacedemo.html#a2790b1b22d1cc8036c14a8d19e8c7aec">demo::initialize_ghs</a></div><div class="ttdeci">void initialize_ghs(GhsState&lt; AN, QN &gt; &amp;ghs, Config &amp;cfg, Comms &amp;c)</div><div class="ttdoc">Helper function to build edges from configuration information.</div><div class="ttdef"><b>Definition:</b> ghs-demo.h:100</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_a7429a609856ffa154ad57e06fd9ac718"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#a7429a609856ffa154ad57e06fd9ac718">le::ghs::GhsState::is_response_required</a></div><div class="ttdeci">Retcode is_response_required(const agent_t &amp;who, bool &amp;response_required)</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:782</div></div>
<div class="ttc" id="astructdemo_1_1Config_html_aaf5064e2ded3f48de39eab485a905eac"><div class="ttname"><a href="structdemo_1_1Config.html#aaf5064e2ded3f48de39eab485a905eac">demo::Config::test</a></div><div class="ttdeci">int test</div><div class="ttdoc">A bool to determine if we should do a test-and-die routine or not.</div><div class="ttdef"><b>Definition:</b> ghs-demo-config.h:76</div></div>
<div class="ttc" id="astructdemo_1_1Config_html_a1f643d712a38616051730426e6ae32d7"><div class="ttname"><a href="structdemo_1_1Config.html#a1f643d712a38616051730426e6ae32d7">demo::Config::command</a></div><div class="ttdeci">enum demo::Config::@0 command</div><div class="ttdoc">A special command enumeration.</div></div>
<div class="ttc" id="anamespacedemo_html_acdd343c748f1c00bfac0d5403b55ba65"><div class="ttname"><a href="namespacedemo.html#acdd343c748f1c00bfac0d5403b55ba65">demo::cfg_is_ok</a></div><div class="ttdeci">bool cfg_is_ok(Config config)</div><div class="ttdef"><b>Definition:</b> ghs-demo-inireader.cpp:184</div></div>
<div class="ttc" id="aclassdemo_1_1Comms_html_ae2a26114df1482d22c7f4a540d4cfea4"><div class="ttname"><a href="classdemo_1_1Comms.html#ae2a26114df1482d22c7f4a540d4cfea4">demo::Comms::print_iperf</a></div><div class="ttdeci">void print_iperf()</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.cpp:407</div></div>
<div class="ttc" id="astatic__queue_8h_html"><div class="ttname"><a href="static__queue_8h.html">static_queue.h</a></div><div class="ttdoc">a static-sized single-ended queue for use in GhsState</div></div>
<div class="ttc" id="anamespacele_1_1ghs_html_a84d3095aaf4e4704c377dd7fe2195632a4826c452cc9fd67119dc4d18c4bacb1b"><div class="ttname"><a href="namespacele_1_1ghs.html#a84d3095aaf4e4704c377dd7fe2195632a4826c452cc9fd67119dc4d18c4bacb1b">le::ghs::DELETED</a></div><div class="ttdeci">@ DELETED</div><div class="ttdoc">We have decided not to further consider this edge, either it was &quot;bad&quot;, or it is already part of our ...</div><div class="ttdef"><b>Definition:</b> edge.h:88</div></div>
<div class="ttc" id="aclassdemo_1_1Comms_html_a2c1d0baea715a9b9f3e63022a5977b57"><div class="ttname"><a href="classdemo_1_1Comms.html#a2c1d0baea715a9b9f3e63022a5977b57">demo::Comms::exchange_iperf</a></div><div class="ttdeci">void exchange_iperf()</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.cpp:355</div></div>
<div class="ttc" id="anamespaceseque_html_a83d9a4dc1b5b513df2fcf67dca9d440ca6db7d02c36017b6c1cea04b4d8d1354d"><div class="ttname"><a href="namespaceseque.html#a83d9a4dc1b5b513df2fcf67dca9d440ca6db7d02c36017b6c1cea04b4d8d1354d">seque::OK</a></div><div class="ttdeci">@ OK</div><div class="ttdoc">OK.</div><div class="ttdef"><b>Definition:</b> static_queue.h:53</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_ac34be79320fdff6ee68650d582fc7756"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#ac34be79320fdff6ee68650d582fc7756">le::ghs::GhsState::get_level</a></div><div class="ttdeci">level_t get_level() const</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:720</div></div>
<div class="ttc" id="astructdemo_1_1Config_html_a332f9a3722fd5ad86c8258eeca7f93f0a246ea6af03d2011fbf1fd4fff4e6be6d"><div class="ttname"><a href="structdemo_1_1Config.html#a332f9a3722fd5ad86c8258eeca7f93f0a246ea6af03d2011fbf1fd4fff4e6be6d">demo::Config::START</a></div><div class="ttdeci">@ START</div><div class="ttdoc">Start MST construction after specified delay.</div><div class="ttdef"><b>Definition:</b> ghs-demo-config.h:85</div></div>
<div class="ttc" id="anamespacedemo_html"><div class="ttname"><a href="namespacedemo.html">demo</a></div><div class="ttdef"><b>Definition:</b> ghs-demo-clireader.cpp:44</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_a99d3eb11d5455ae117d917555a429842"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#a99d3eb11d5455ae117d917555a429842">le::ghs::GhsState::reset</a></div><div class="ttdeci">Retcode reset()</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:66</div></div>
<div class="ttc" id="anamespacedemo_html_abf8c1fc7556d7ead827da53c62c160afa650898b110370730426d95e0363f62ef"><div class="ttname"><a href="namespacedemo.html#abf8c1fc7556d7ead827da53c62c160afa650898b110370730426d95e0363f62ef">demo::ERR_HANGUP</a></div><div class="ttdeci">@ ERR_HANGUP</div><div class="ttdoc">Connection was lost.</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:79</div></div>
<div class="ttc" id="aclassdemo_1_1GhsDemoExec_html"><div class="ttname"><a href="classdemo_1_1GhsDemoExec.html">demo::GhsDemoExec</a></div><div class="ttdoc">The main demo logic for executing le::ghs::GhsState across a network</div><div class="ttdef"><b>Definition:</b> ghs-demo.h:70</div></div>
<div class="ttc" id="astructle_1_1ghs_1_1Edge_html_a2aadbbe58e3ae3143c7e228dc5aae2a8"><div class="ttname"><a href="structle_1_1ghs_1_1Edge.html#a2aadbbe58e3ae3143c7e228dc5aae2a8">le::ghs::Edge::root</a></div><div class="ttdeci">agent_t root</div><div class="ttdoc">The root is the &quot;from&quot; side of the edge.</div><div class="ttdef"><b>Definition:</b> edge.h:104</div></div>
<div class="ttc" id="aclassdemo_1_1Comms_html"><div class="ttname"><a href="classdemo_1_1Comms.html">demo::Comms</a></div><div class="ttdoc">a message passing class that uses nng, suitable for testing GhsState</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:199</div></div>
<div class="ttc" id="anamespacedemo_html_a7d48c79c4beff0ef6734a1aeb0742093"><div class="ttname"><a href="namespacedemo.html#a7d48c79c4beff0ef6734a1aeb0742093">demo::kill_edge</a></div><div class="ttdeci">void kill_edge(GhsState&lt; AN, QN &gt; &amp;ghs, Config &amp;cfg, uint8_t agent_to)</div><div class="ttdoc">Helper function to remove an edge from the GhsState, but trying to do sanely and without interrupting...</div><div class="ttdef"><b>Definition:</b> ghs-demo.h:123</div></div>
<div class="ttc" id="anamespacedemo_html_abf8c1fc7556d7ead827da53c62c160afa7266344c8c38721c5322937df92267d6"><div class="ttname"><a href="namespacedemo.html#abf8c1fc7556d7ead827da53c62c160afa7266344c8c38721c5322937df92267d6">demo::ERR_NNG</a></div><div class="ttdeci">@ ERR_NNG</div><div class="ttdoc">NNG returned an error code, please see logging output.</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:80</div></div>
<div class="ttc" id="astructdemo_1_1Header_html_add10fe1bdb49ba9d102eb84df7bb64d1"><div class="ttname"><a href="structdemo_1_1Header.html#add10fe1bdb49ba9d102eb84df7bb64d1">demo::Header::payload_size</a></div><div class="ttdeci">uint16_t payload_size</div><div class="ttdoc">how big is the payload we carry?</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:143</div></div>
<div class="ttc" id="astructdemo_1_1WireMessage_html_adb278e8de580811ea58b6567494f2b48"><div class="ttname"><a href="structdemo_1_1WireMessage.html#adb278e8de580811ea58b6567494f2b48">demo::WireMessage::header</a></div><div class="ttdeci">Header header</div><div class="ttdoc">Msg meta information.</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:175</div></div>
<div class="ttc" id="aghs__printer_8h_html_a33004d9801352831b8e199c7d17cbb3d"><div class="ttname"><a href="ghs__printer_8h.html#a33004d9801352831b8e199c7d17cbb3d">dump_edges</a></div><div class="ttdeci">std::string dump_edges(const le::ghs::GhsState&lt; N, A &gt; &amp;)</div><div class="ttdoc">Will dump edges in a readable format.</div></div>
<div class="ttc" id="astructdemo_1_1Config_html_a14a344d67e7207aac087351cf2b0ae26"><div class="ttname"><a href="structdemo_1_1Config.html#a14a344d67e7207aac087351cf2b0ae26">demo::Config::my_id</a></div><div class="ttdeci">int my_id</div><div class="ttdoc">This agent's id.</div><div class="ttdef"><b>Definition:</b> ghs-demo-config.h:79</div></div>
<div class="ttc" id="amsg__printer_8h_html"><div class="ttname"><a href="msg__printer_8h.html">msg_printer.h</a></div><div class="ttdoc">provides the implementation of std::ostream operations for lg::ghs objects</div></div>
<div class="ttc" id="anamespacedemo_html_a40728478aebe86a16a658e832186e97ca90d93bb46f68d3452708e7bf4a7eb1a4"><div class="ttname"><a href="namespacedemo.html#a40728478aebe86a16a658e832186e97ca90d93bb46f68d3452708e7bf4a7eb1a4">demo::PAYLOAD_TYPE_GHS</a></div><div class="ttdeci">@ PAYLOAD_TYPE_GHS</div><div class="ttdoc">message was intended for GHS, don't process, just send it</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:93</div></div>
<div class="ttc" id="astructle_1_1ghs_1_1Msg_html"><div class="ttname"><a href="structle_1_1ghs_1_1Msg.html">le::ghs::Msg</a></div><div class="ttdoc">An aggregate type containing all the data to exchange with to/from information.</div><div class="ttdef"><b>Definition:</b> msg.h:137</div></div>
<div class="ttc" id="astructle_1_1ghs_1_1Edge_html_ac5af30e895dd30418def560ffbcd83a9"><div class="ttname"><a href="structle_1_1ghs_1_1Edge.html#ac5af30e895dd30418def560ffbcd83a9">le::ghs::Edge::peer</a></div><div class="ttdeci">agent_t peer</div><div class="ttdoc">The peer is the &quot;to&quot; side of the edge.</div><div class="ttdef"><b>Definition:</b> edge.h:102</div></div>
<div class="ttc" id="aghs_8h_html"><div class="ttname"><a href="ghs_8h.html">ghs.h</a></div><div class="ttdoc">The main GhsState object</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_a32752d80f78b09c368236e864de84e0d"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#a32752d80f78b09c368236e864de84e0d">le::ghs::GhsState::has_edge</a></div><div class="ttdeci">bool has_edge(const agent_t &amp;to) const</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:824</div></div>
<div class="ttc" id="aclassseque_1_1StaticQueue_html"><div class="ttname"><a href="classseque_1_1StaticQueue.html">seque::StaticQueue</a></div><div class="ttdoc">a static-sized single-ended queue for use in GhsState</div><div class="ttdef"><b>Definition:</b> static_queue.h:83</div></div>
<div class="ttc" id="aclassdemo_1_1Comms_html_a75296ec19c2098d8d9860baf311fc72e"><div class="ttname"><a href="classdemo_1_1Comms.html#a75296ec19c2098d8d9860baf311fc72e">demo::Comms::start_receiver</a></div><div class="ttdeci">void start_receiver()</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.cpp:472</div></div>
<div class="ttc" id="anamespacele_1_1ghs_html_a84d3095aaf4e4704c377dd7fe2195632a84d0576afb701bea755a6cd2752555f2"><div class="ttname"><a href="namespacele_1_1ghs.html#a84d3095aaf4e4704c377dd7fe2195632a84d0576afb701bea755a6cd2752555f2">le::ghs::UNKNOWN</a></div><div class="ttdeci">@ UNKNOWN</div><div class="ttdoc">We have not probed this edge for information yet, or have not recieved a reponse.</div><div class="ttdef"><b>Definition:</b> edge.h:84</div></div>
<div class="ttc" id="astructdemo_1_1Config_html_ae26f1eefefaa9ab4a250ded8cd385e45"><div class="ttname"><a href="structdemo_1_1Config.html#ae26f1eefefaa9ab4a250ded8cd385e45">demo::Config::retry_connections</a></div><div class="ttdeci">bool retry_connections</div><div class="ttdoc">If we fail to dial up an agent, should we retry later (true) or drop the message (false)</div><div class="ttdef"><b>Definition:</b> ghs-demo-config.h:90</div></div>
<div class="ttc" id="aedge_8h_html"><div class="ttname"><a href="edge_8h.html">edge.h</a></div><div class="ttdoc">Edge structure definition and functions.</div></div>
<div class="ttc" id="anamespacele_1_1ghs_html_aac347dba4047a0b57893ee8895e66acba3e8f07e33611d026ddfea23364d4c437"><div class="ttname"><a href="namespacele_1_1ghs.html#aac347dba4047a0b57893ee8895e66acba3e8f07e33611d026ddfea23364d4c437">le::ghs::OK</a></div><div class="ttdeci">@ OK</div><div class="ttdoc">The operation was successful.</div><div class="ttdef"><b>Definition:</b> ghs.h:72</div></div>
<div class="ttc" id="astructle_1_1ghs_1_1Edge_html_aa097ecc6d3006a9442a61836b6a8b9c8"><div class="ttname"><a href="structle_1_1ghs_1_1Edge.html#aa097ecc6d3006a9442a61836b6a8b9c8">le::ghs::Edge::status</a></div><div class="ttdeci">status_t status</div><div class="ttdoc">The status of this edge, starting with UNKNOWN.</div><div class="ttdef"><b>Definition:</b> edge.h:106</div></div>
<div class="ttc" id="astructdemo_1_1WireMessage_html_aaa2782b2201a65e477b0a54ae55509fc"><div class="ttname"><a href="structdemo_1_1WireMessage.html#aaa2782b2201a65e477b0a54ae55509fc">demo::WireMessage::bytes</a></div><div class="ttdeci">uint8_t bytes[PAYLOAD_MAX_SZ]</div><div class="ttdoc">The actual payload to send. Note only the first N=demo::WireMessageHeader::payload_size will be sent ...</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:177</div></div>
<div class="ttc" id="astructdemo_1_1Config_html"><div class="ttname"><a href="structdemo_1_1Config.html">demo::Config</a></div><div class="ttdoc">A struct that holds the union of all configuration variables.</div><div class="ttdef"><b>Definition:</b> ghs-demo-config.h:64</div></div>
<div class="ttc" id="aclassseque_1_1StaticQueue_html_ae1614af1da8a98ff8b0e8666de036a88"><div class="ttname"><a href="classseque_1_1StaticQueue.html#ae1614af1da8a98ff8b0e8666de036a88">seque::StaticQueue::pop</a></div><div class="ttdeci">Retcode pop()</div><div class="ttdef"><b>Definition:</b> static_queue_impl.hpp:95</div></div>
<div class="ttc" id="aghs-demo-config_8h_html"><div class="ttname"><a href="ghs-demo-config_8h.html">ghs-demo-config.h</a></div><div class="ttdoc">contains all the Config objects and methods for configuring demo::Comms</div></div>
<div class="ttc" id="aghs__printer_8h_html"><div class="ttname"><a href="ghs__printer_8h.html">ghs_printer.h</a></div><div class="ttdoc">some conveneience implementations to print le::ghs::GhsState objects with std::ostream</div></div>
<div class="ttc" id="anamespacedemo_html_a058a0c6f9b6498fbf7108227b4ed2496"><div class="ttname"><a href="namespacedemo.html#a058a0c6f9b6498fbf7108227b4ed2496">demo::read_cfg_stdin</a></div><div class="ttdeci">void read_cfg_stdin(Config *c)</div><div class="ttdef"><b>Definition:</b> ghs-demo-inireader.cpp:211</div></div>
<div class="ttc" id="aclassdemo_1_1GhsDemoExec_html_af699fd10cf0f833f88e4fdb32cbce039"><div class="ttname"><a href="classdemo_1_1GhsDemoExec.html#af699fd10cf0f833f88e4fdb32cbce039">demo::GhsDemoExec::do_main</a></div><div class="ttdeci">int do_main(int argc, char **argv)</div><div class="ttdoc">A single entry point function that should be called from main()</div><div class="ttdef"><b>Definition:</b> ghs-demo.h:166</div></div>
<div class="ttc" id="aclassdemo_1_1Comms_html_a6ce39da083f7393eed3e23af716671c9"><div class="ttname"><a href="classdemo_1_1Comms.html#a6ce39da083f7393eed3e23af716671c9">demo::Comms::stop_receiver</a></div><div class="ttdeci">void stop_receiver()</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.cpp:477</div></div>
<div class="ttc" id="aagent_8h_html"><div class="ttname"><a href="agent_8h.html">agent.h</a></div><div class="ttdoc">provides le::ghs::agent_t defintion</div></div>
<div class="ttc" id="aclassdemo_1_1Comms_html_a1b2497ecccf0316c8e8c3a643037a8cc"><div class="ttname"><a href="classdemo_1_1Comms.html#a1b2497ecccf0316c8e8c3a643037a8cc">demo::Comms::unique_link_metric_to</a></div><div class="ttdeci">CommsEdgeMetric unique_link_metric_to(const uint16_t agent_id) const</div><div class="ttdoc">This function is really important for the working of your system</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.cpp:483</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_aabb95007147563e87a19aaca69531ce2"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#aabb95007147563e87a19aaca69531ce2">le::ghs::GhsState::delayed_count</a></div><div class="ttdeci">size_t delayed_count() const</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:947</div></div>
<div class="ttc" id="anamespacedemo_html_ad8a09bcb86eeb80494bed646f3fa0fae"><div class="ttname"><a href="namespacedemo.html#ad8a09bcb86eeb80494bed646f3fa0fae">demo::do_test_and_die</a></div><div class="ttdeci">int do_test_and_die(Comms &amp;comms, Config &amp;config)</div><div class="ttdoc">Run a quick little_iperf() round to check connectivity.</div><div class="ttdef"><b>Definition:</b> ghs-demo.h:144</div></div>
<div class="ttc" id="aclassdemo_1_1Comms_html_a722a2024af447ac2ecefd15773c56fc2"><div class="ttname"><a href="classdemo_1_1Comms.html#a722a2024af447ac2ecefd15773c56fc2">demo::Comms::get_next</a></div><div class="ttdeci">bool get_next(demo::WireMessage &amp;)</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.cpp:300</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_abba914bec431efab91efc47c7f105057"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#abba914bec431efab91efc47c7f105057">le::ghs::GhsState::get_parent_id</a></div><div class="ttdeci">agent_t get_parent_id() const</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:704</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_a491d9729e0a7ec8ec63e12c261c63af6"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#a491d9729e0a7ec8ec63e12c261c63af6">le::ghs::GhsState::get_edge</a></div><div class="ttdeci">Retcode get_edge(const agent_t &amp;to, Edge &amp;out) const</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:830</div></div>
<div class="ttc" id="astructle_1_1ghs_1_1Edge_html_a8007d7f31ee60a36a944be01a4f6d60d"><div class="ttname"><a href="structle_1_1ghs_1_1Edge.html#a8007d7f31ee60a36a944be01a4f6d60d">le::ghs::Edge::metric_val</a></div><div class="ttdeci">metric_t metric_val</div><div class="ttdoc">By default, this edge has metric_val = WORST_METRIC.</div><div class="ttdef"><b>Definition:</b> edge.h:108</div></div>
<div class="ttc" id="astructdemo_1_1Config_html_a5349577afa3f1ef846f84f9b7f36d684"><div class="ttname"><a href="structdemo_1_1Config.html#a5349577afa3f1ef846f84f9b7f36d684">demo::Config::n_agents</a></div><div class="ttdeci">int n_agents</div><div class="ttdoc">The number of agents currently loaded.</div><div class="ttdef"><b>Definition:</b> ghs-demo-config.h:70</div></div>
<div class="ttc" id="astructle_1_1ghs_1_1Edge_html"><div class="ttname"><a href="structle_1_1ghs_1_1Edge.html">le::ghs::Edge</a></div><div class="ttdoc">A struct to hold all the communication edge information.</div><div class="ttdef"><b>Definition:</b> edge.h:96</div></div>
<div class="ttc" id="anamespacedemo_html_a69165e1dd34db70c8f2dd6fc9457c3c5"><div class="ttname"><a href="namespacedemo.html#a69165e1dd34db70c8f2dd6fc9457c3c5">demo::read_cfg_cli</a></div><div class="ttdeci">void read_cfg_cli(int argc, char **argv, Config *config)</div><div class="ttdef"><b>Definition:</b> ghs-demo-clireader.cpp:94</div></div>
<div class="ttc" id="anamespacedemo_html_a40728478aebe86a16a658e832186e97ca6ebaba8135dfea1dd78fdef26f257d0a"><div class="ttname"><a href="namespacedemo.html#a40728478aebe86a16a658e832186e97ca6ebaba8135dfea1dd78fdef26f257d0a">demo::PAYLOAD_TYPE_CONTROL</a></div><div class="ttdeci">@ PAYLOAD_TYPE_CONTROL</div><div class="ttdoc">Control message are for resetting internal state or commanding.</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:90</div></div>
<div class="ttc" id="aclassdemo_1_1Comms_html_aee289f13ddf0feed4d64a80ee40c140e"><div class="ttname"><a href="classdemo_1_1Comms.html#aee289f13ddf0feed4d64a80ee40c140e">demo::Comms::send</a></div><div class="ttdeci">Errno send(demo::WireMessage &amp;, demo::OptMask=0)</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.cpp:336</div></div>
<div class="ttc" id="astructle_1_1ghs_1_1Msg_html_ab98db415023ed82008b48e8749b8a322"><div class="ttname"><a href="structle_1_1ghs_1_1Msg.html#ab98db415023ed82008b48e8749b8a322">le::ghs::Msg::to</a></div><div class="ttdeci">agent_t to</div><div class="ttdoc">who to send to</div><div class="ttdef"><b>Definition:</b> msg.h:150</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_acf6f3f76c3e48e65e00e2887a9592d9f"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#acf6f3f76c3e48e65e00e2887a9592d9f">le::ghs::GhsState::is_converged</a></div><div class="ttdeci">bool is_converged() const</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:731</div></div>
<div class="ttc" id="anamespacele_1_1ghs_html_aae453b8c5ad07a483f01c531dbe3cd78"><div class="ttname"><a href="namespacele_1_1ghs.html#aae453b8c5ad07a483f01c531dbe3cd78">le::ghs::strerror</a></div><div class="ttdeci">const char * strerror(const Retcode &amp;r)</div><div class="ttdef"><b>Definition:</b> ghs.cpp:44</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html_a6789e0899e91d62a6d2cc11a66833d89"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html#a6789e0899e91d62a6d2cc11a66833d89">le::ghs::GhsState::get_leader_id</a></div><div class="ttdeci">agent_t get_leader_id() const</div><div class="ttdef"><b>Definition:</b> ghs_impl.hpp:709</div></div>
<div class="ttc" id="astructdemo_1_1Header_html_aef68c9783cad9ea4952d7753fc03f517"><div class="ttname"><a href="structdemo_1_1Header.html#aef68c9783cad9ea4952d7753fc03f517">demo::Header::agent_to</a></div><div class="ttdeci">Destination agent_to</div><div class="ttdoc">Which agent id is this sent to?</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:137</div></div>
<div class="ttc" id="anamespacedemo_html_abf8c1fc7556d7ead827da53c62c160afa58b77192fdebafe13fc97074d128e85b"><div class="ttname"><a href="namespacedemo.html#abf8c1fc7556d7ead827da53c62c160afa58b77192fdebafe13fc97074d128e85b">demo::OK</a></div><div class="ttdeci">@ OK</div><div class="ttdoc">No error.</div><div class="ttdef"><b>Definition:</b> ghs-demo-comms.h:73</div></div>
<div class="ttc" id="astructle_1_1ghs_1_1Msg_html_a67f976eac93bace02a9ef4ca6817a182"><div class="ttname"><a href="structle_1_1ghs_1_1Msg.html#a67f976eac93bace02a9ef4ca6817a182">le::ghs::Msg::from</a></div><div class="ttdeci">agent_t from</div><div class="ttdoc">who it is from</div><div class="ttdef"><b>Definition:</b> msg.h:153</div></div>
<div class="ttc" id="aclassle_1_1ghs_1_1GhsState_html"><div class="ttname"><a href="classle_1_1ghs_1_1GhsState.html">le::ghs::GhsState</a></div><div class="ttdoc">The main state machine for the GHS algorithm</div><div class="ttdef"><b>Definition:</b> ghs.h:124</div></div>
<div class="ttc" id="astructdemo_1_1Config_html_ae46a80fa61b7d31743cd11a8b78b5809"><div class="ttname"><a href="structdemo_1_1Config.html#ae46a80fa61b7d31743cd11a8b78b5809">demo::Config::wait_s</a></div><div class="ttdeci">float wait_s</div><div class="ttdoc">The time to wait before starting the main algorithm.</div><div class="ttdef"><b>Definition:</b> ghs-demo-config.h:67</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
